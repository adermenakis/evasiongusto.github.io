#!/usr/bin/env node
const fs=require("fs").promises,path=require("path"),LQIP_DATA_FILE="./lqip-data.json",HTML_FILE="./index.html";async function main(){console.log("ðŸ”„ Injecting LQIPs into HTML (Simple Replacement)...\n");const e=JSON.parse(await fs.readFile(LQIP_DATA_FILE,"utf8")),a=new Map;e.forEach(e=>{const i=path.basename(e.original);a.set(i,e.lqip)});let i=await fs.readFile(HTML_FILE,"utf8"),t=0;e.forEach(e=>{const a=e.original,n=e.lqip,s=new RegExp(`(src=")data:image/svg\\+xml[^"]*"([^"]*"[^>]*data-src="${a.replace(/\//g,"\\/")}")`,"g"),o=`$1${n}"$2`,l=i.replace(s,o);l!==i&&(console.log(`âœ“ ${a}`),i=l,t++)}),await fs.writeFile(HTML_FILE,i,"utf8"),console.log(`\nâœ… Updated ${t} images with LQIPs`)}main().catch(console.error);